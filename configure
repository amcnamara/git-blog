#!/usr/bin/env bash

source ./bin/_git-blog-helpers.sh

plumb_logs $@

pbold "Writing global config map for social accounts and CDN..."

mkdir -p $CONFIG_BASEDIR

# Configure social handles
read -e -p "$(echo -e ${NOCOLOUR})Twitter handle (or leave blank): $(echo -e ${WHITE})" -i "$(echo_config_attribute 'twitter')" twitter 2>&1
write_config_attribute "twitter" $twitter

read -e -p "$(echo -e ${NOCOLOUR})Facebook handle (or leave blank): $(echo -e ${WHITE})" -i "$(echo_config_attribute 'facebook')" facebook 2>&1
write_config_attribute "facebook" $facebook

read -e -p "$(echo -e ${NOCOLOUR})Email address (or leave blank): $(echo -e ${WHITE})" -i "$(echo_config_attribute 'email')" email 2>&1
write_config_attribute "email" $email

# Configure blog hosting metadata
read -e -p "$(echo -e ${NOCOLOUR})AWS hosting region: $(echo -e ${WHITE})" -i "$(echo_config_attribute 'region')" region 2>&1
write_config_attribute "region" $region

read -e -p "$(echo -e ${NOCOLOUR})S3 bucket ARN: $(echo -e ${WHITE})" -i "$(echo_config_attribute 'bucket')" bucket 2>&1
write_config_attribute "bucket" $bucket

read -e -p "$(echo -e ${NOCOLOUR})Blog domain (including http[s]://): $(echo -e ${WHITE})" -i "$(echo_config_attribute 'domain')" domain 2>&1
write_config_attribute "domain" $domain

if [[ -z $bucket || -z $region ]]; then
pwarning "No bucket location or region provided, please provision before publishing"
fi
